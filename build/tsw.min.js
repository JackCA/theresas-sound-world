/* Theresa's Sound World 0.0.1 (c) 2013 Stuart Memo */
window.tsw=function(e,t){"use strict";var n=function(e,t){for(var n in t)e[n]=t[n];return e},r=function(e,t){for(var n in t)e[n].value=t[n]},a=function(e){return Array.isArray(e)},o=function(e){var t=!1;return Object(e)&&"node"in e&&(t=!0),t},u=function(e){return e.context!==t},i=function(e){return e.hasOwnProperty("input")||e.hasOwnProperty("output")},c={},s=[];c.version="0.0.1",c.isBrowserSupported=!1,c.processors=[];var f=function(){c.noise_buffer=c.createBuffer();for(var e=0;c.noise_buffer.length>e;e++)c.noise_buffer.getChannelData(0)[e]=2*Math.random()-1},p=function(e,n){if("undefined"==typeof webkitAudioContext&&"undefined"==typeof AudioContext)if(webkitAudioContext.prototype.createGainNode===t)n("Sorry, your browser doesn't support a recent enough version of the Web Audio API.");else{var r=webkitAudioContext.prototype;r.createGain=r.createGainNode,r.createDelay=r.createDelayNode,r.createScriptProcessor=r.createJavaScriptNode}else c.context="function"==typeof AudioContext?new AudioContext:new webkitAudioContext;c.isBrowserSupported=!0,e()},l=function(){c.speakers=c.context.destination};c.createNode=function(){var e={};return e.input=c.createGain(),e.output=c.createGain(),e},c.now=function(){return this.context.currentTime},c.createChannelMerger=function(e){return c.context.createChannelMerger(e)},c.connect=function(){for(var e=function(){arguments[0].connect(arguments[1])},t=function(){arguments[0].connect(arguments[1].input)},n=function(){for(var e=0;arguments[1].length>e;e++)c.connect(arguments[0],arguments[1][e])},r=function(){for(var e=0;arguments[0].length>e;e++)c.connect(arguments[0][e],arguments[1])},s=function(){arguments[0].output.connect(arguments[1].input)},f=function(){arguments[0].output.connect(arguments[1])},p=function(){for(var e=0;arguments[0].length>e;e++)this.connect(arguments[0][e],arguments[1])},l=function(){for(var e=0;arguments[0].length>e;e++)this.connect(arguments[0][e],arguments[1])},h=function(){arguments[0].node.connect(arguments[1].node,arguments[0].channel,arguments[1].channel)},v=0;arguments.length-1>v;v++){var m=arguments[v],d=arguments[v+1];u(m)&&i(d)?t(m,d):i(m)&&u(d)?f(m,d):u(m)&&a(d)?n(m,d):a(m)&&u(d)?r(m,d):u(m)&&u(d)?e(m,d):i(m)&&i(d)?s(m,d):i(m)&&a(d)?connectTswNodeToArray(m,d):a(m)&&i(d)?p(m,d):a(m)&&a(d)?l(m,d):o(m)&&a(d)?connectObjectWithNodeToArray(m,d):a(m)&&o(d)?connectArrayToObjectWithNode(m,d):o(m)&&o(d)&&h(m,d)}},c.disconnect=function(){for(var e=arguments.length,t=0;e>t;t++)arguments[t].disconnect()},c.disconnectAfterTime=function(e,t){s.push({node:e,time:t})},c.load=function(){var e,t={},n=arguments[0],r="",a=[],o=0,u=0,i=this,s=function(e,t,n,r,a){var s=new XMLHttpRequest;s.open("GET",e+n,!0),s.responseType="arraybuffer",s.onload=function(){o++,i.context.decodeAudioData(s.response,function(e){e.play=function(e){var t=c.createBufferSource(this);t.start(c.now()||e)},r[t]=e,o===u&&a(r)})},function(e){console.log("Error decoding audio data",e)},s.send()};if("object"==typeof arguments[1]?(r=arguments[1].path||"",a=arguments[1].extensions||[]):"function"==typeof arguments[1]&&(e=arguments[1]),"function"==typeof arguments[2]&&(e=arguments[2]),"object"==typeof n)for(var f in n)u++,s(r,f,n[f],t,e);else{if("string"!=typeof n)throw Error("Files must be an array or a valid string.");u=1,s(r,f,n[f],t,e)}},c.createDelay=function(e){var t=this.context.createDelay();return t.delayTime.value=e||0,t},c.createMonoMaker=function(){var e={};return e.input=c.createGain(),e.output=c.createGain(),c.connect(e.input,e.output),e},c.createPanner=function(e){var t={},n=c.createGain(1),r=c.createGain(0),a=c.createChannelMerger(2);return t.input=c.createGain(),t.output=c.createGain(),t.value=e,t.value>1?t.value=1:-1>t.value&&(t.value=-1),n.gain.value=1-100*.01*((1+t.value)/2),r.gain.value=1-n.gain.value,c.connect(t.input,[n,r]),c.connect({node:n,channel:0},{node:a,channel:0}),c.connect({node:r,channel:0},{node:a,channel:1}),c.connect(a,t.output),t},c.play=function(e,t){t=t||0,e.start(t)},c.stop=function(e,t){t=t||0,e.stop(t)},c.reverse=function(e){for(var t=0;e.buffer.numberOfChannels>t;t++)Array.prototype.reverse.call(e.buffer.getChannelData(t));return e};var h=function(e,t){e.connectedTo=[],e.get=function(t){return e[t].hasOwnProperty("value")?e[t].value:e[t].value},t.sourceNode&&e.hasOwnProperty("start")&&(e.start=e.start||e.noteOn,e.stop=e.start||e.noteOff)};c.createOscillator=function(e,t){var n=this.context.createOscillator();return h(n,{sourceNode:!0}),e=e||"sine",n.type=e.toLowerCase(),n.frequency.value=t||440,n.nodeType="oscillator",n},c.createGain=function(e){var n;return n="function"==typeof this.context.createGain?this.context.createGain():this.context.createGainNode(),0>=e&&(e=0),e===t&&(e=1),n.gain.value=e,n},c.createBuffer=function(e,t,n){e=e||1,t=t||65536,n=n||44100;var r=this.context.createBuffer(e,t,n);return r.play=function(e){var t=c.createBufferSource(this);t.start(e||c.now())},r},c.createBufferSource=function(e){var n=this.context.createBufferSource();return n.buffer=e,n.start===t&&(n.start=n.noteOn,n.stop=n.noteOff),n},c.createFilter=function(e,t,n){var r=e||"lowpass",a={},o=c.context.createBiquadFilter();return a.input=c.createGain(),a.output=c.createGain(),o.type=r,o.frequency.value=t||1e3,o.Q.value=n||0,a.get=function(e){return o[e].value},a.set=function(e){o.frequency.value=e.frequency},c.connect(a.input,o,a.output),a},c.createAnalyser=function(){return this.context.createAnalyser()},c.createCompressor=function(e){var t=this.context.createDynamicsCompressor(),a={threshold:-24,knee:30,ratio:12,attack:.003,release:.25};return e=n(a,e),r(t,e),t},c.createProcessor=function(e,t){var n=e||1024,r=c.context.createScriptProcessor(n,1,1);return"function"==typeof t&&(r.onaudioprocess=function(e){t(e)}),r},c.createWaveShaper=function(){for(var e=new Float32Array(65536),t=0;32768>t;t++)e[t]=3e4>t?.1:-1;var n=this.context.createWaveShaper();return n.curve=e,n},c.createEnvelope=function(e){var n={};return e=e||{},n.startLevel=e.startLevel||0,n.maxLevel=e.maxLevel||1,n.minLevel=e.minLevel||0,n.attackTime=e.attackTime||0,n.decayTime=e.decayTime||0,n.sustainLevel=e.sustainLevel||0,n.releaseTime=e.releaseTime||0,n.param=e.param||{},n.param.value=n.startLevel,n.autoStop=e.autoStop===t?!0:e.autoStop,n.start=function(e){this.maxLevel=this.startLevel+this.maxLevel,this.sustainLevel=this.startLevel+this.sustainLevel;var t=e||c.now(),n=t+this.attackTime,r=n+this.decayTime,a=r+this.releaseTime;this.param.cancelScheduledValues(t),this.param.setValueAtTime(this.startLevel,t),this.param.linearRampToValueAtTime(this.maxLevel,n),this.param.linearRampToValueAtTime(this.startLevel+this.sustainLevel,r),this.autoStop&&(this.param.linearRampToValueAtTime(this.minLevel,a),this.stop(a))},n.stop=function(e){e=e||c.now(),e+=this.releaseTime,this.autoStop||this.param.linearRampToValueAtTime(this.minLevel,this.releaseTime)},n},c.createNoise=function(e){var t=c.createNode(),n=this.createBufferSource(c.noise_buffer),r=c.createFilter("lowpass");return n.loop=!0,t.nodeType="noise",t.color=e||"white",r.frequency="pink"===t.color?1e3:1e4,t.start=function(e){n.start(e||c.now())},c.connect(n,r,t.output),t},c.createLFO=function(e){var t=c.createOscillator(),r=this.createGain(),a={frequency:0,waveType:"triangle",depth:1,target:null,autoStart:!1};return e=n(a,e),t.type=t[e.waveType]||t.TRIANGLE,r.gain.value=e.depth,t.frequency.value=e.frequency,e.autoStart&&t.start(c.now()),t.modulate=function(e){this.connect(r),r.connect(e)},t.setWaveType=function(e){t.type=t[e.toUpperCase()]},t.setFrequency=function(e){t.frequency.value=e},t.setDepth=function(e){r.gain.value=e},t.modulate(e.target),t},c.getUserAudio=function(e){var t=function(t){var n=c.context.createMediaStreamSource(t);e(n)};navigator.webkitGetUserMedia({audio:!0},t)};var v=function(){(function e(){s.forEach(function(e){e.time<c.now()&&c.disconnect(e.node)}),setTimeout(e,500)})()};return function(){p(function(){l(),f(),v()},function(e){console.log(e)})}(),c}(window),function(e){"use strict";e.tsw=tsw||{},tsw.createDelay=function(e){var t={},n=tsw.context.createDelay(),r=tsw.context.createGain(),a=tsw.context.createGain(),o=tsw.createGain();return t.input=tsw.createGain(),t.output=tsw.createGain(),t.settings={delayTime:.5,feedback:.5,effectLevel:.5},e=e||{},n.delayTime.value=e.delayTime||t.settings.delayTime,r.gain.value=e.feedback||t.settings.feedback,a.gain.value=e.effectLevel||t.settings.effectLevel,tsw.connect(t.input,o,n,r,n,a,t.output),tsw.connect(o,n),t},tsw.createDistortion=function(e){var t={},n=tsw.context.createWaveShaper(),r=tsw.context.createBiquadFilter(),a=tsw.context.createBiquadFilter();return t.settings={distortionLevel:.5},e=e||{},t.input=tsw.createGain(),t.output=tsw.createGain(),tsw.connect(t.input,n,[r,a],t.output),t},tsw.createFlanger=function(){var e={};return e},tsw.createPhaser=function(e){var t={},n=[],r=tsw.createGain(),a={rate:8,depth:.5,feedback:.8};e=e||{},r.gain.value=e.gain||a.gain;for(var o=0;a.rate>o;o++)n[o]=tsw.context.createBiquadFilter(),n[o].type=7,n[o].frequency.value=100*o;t.input=tsw.createGain(),t.output=tsw.createGain();for(var o=0;n.length-1>o;o++)tsw.connect(n[o],n[o+1]);return tsw.connect(t.input,n[0],n[n.length-1],r,n[0]),tsw.connect(n[n.length-1],t.output),t.setCutoff=function(){for(var e=0;n.length>e;e++);},t},tsw.createReverb=function(e){var t=tsw.context.createConvolver(),n=tsw.createGain(),r={},a={effectLevel:.5,reverbTime:.5,reverbType:"spring",reverbPath:""};return e=e||{},n.gain.value=e.effectLevel||a.effectLevel,tsw.load({hall:"/effects/reverb/responses/bright-hall.wav",room:"/effects/reverb/responses/medium-room.wav",spring:"/effects/reverb/responses/feedback-spring.wav"},function(e){a.reverbPath=e[a.reverbType],t.buffer=a.reverbPath,r.input=tsw.createGain(),r.output=tsw.createGain(),tsw.connect(r.input,[r.output,t]),tsw.connect(t,n),tsw.connect(n,r.output)}),r},tsw.createTremolo=function(e){var t={},n=(tsw.createGain(),this.createLFO()),r=this;return e=e||{},t.input=tsw.createGain(),t.connect=function(e){t.input.connect(e),n.modulate(t.input.gain),n.start(r.now())},t.setRate=function(e){n.setFrequency(e)},t.setDepth=function(e){n.setDepth(e)},t},console.log(tsw)}(window),function(){"use strict";var e=["A","A#","B","C","C#","D","D#","E","F","F#","G","G#"];e=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],e.push.apply(e,e);var t=["unison","flat 2nd","2nd","minor 3rd","major 3rd","perfect 4th","flat 5th","perfect 5th","minor 6th","major 6th","minor 7th","major 7th","octave","flat 9th","9th","sharp 9th","major 10th","11th","augmented 11th","perfect 12th","flat 13th","13th"],n=function(t){for(var n,r=e.length,a=0;r>a;a++)if(t.toUpperCase()===e[a])return n=a,a;return null},r=function(t){var r=[],a=n(t);return r.push(e[a]),r.push(e[a+2]),r.push(e[a+4]),r.push(e[a+5]),r.push(e[a+7]),r.push(e[a+9]),r.push(e[a+11]),r.push(e[a+12]),r},a=function(t){var r=[],a=n(t);return r.push(e[a]),r.push(e[a+2]),r.push(e[a+3]),r.push(e[a+5]),r.push(e[a+7]),r.push(e[a+8]),r.push(e[a+10]),r.push(e[a+12]),r},o=function(e){return"string"!=typeof e||e.length>3?!1:!0};tsw.parseChord=function(t){var r={},a=[],o=0;return Array.isArray(t)?!1:(t=t.toLowerCase(),r.rootNote=t[0].toUpperCase(),r.isMajor=t.indexOf("maj")>-1,r.isMinor=!r.isMajor&&t.indexOf("m")>-1,r.is7th=t.indexOf("7")>-1,r.notes=[],r.is7th||(r.octave=t.match(/\d/g)),r.isMajor||r.isMinor?(o=n(r.rootNote),a.push(o),t.isMinor?a.push(o+tsw.getSemitoneDifference("minor 3rd")):a.push(o+tsw.getSemitoneDifference("major 3rd")),a.push(o+tsw.getSemitoneDifference("perfect 5th")),a.push(o+tsw.getSemitoneDifference("octave")),a.forEach(function(t){r.notes.push(e[t])}),r.notes):!1)},tsw.getScale=function(e,t){return"minor"===t?a(e):r(e)},tsw.getSemitoneDifference=function(e){for(var n=t.length,r=0;n>r;r++)if(e===t[r])return r},tsw.getChord=function(e){return this.parseChord(e)},tsw.chordToNotes=function(e){return e=this.parseChord(e),e.notes},tsw.sharpToFlat=function(e){var t;return e=e.replace("#","b"),t=String.fromCharCode(e[0].toUpperCase().charCodeAt(0)+1),"H"===t&&(t="A"),t+=e.substr(1)},tsw.flatToSharp=function(e){var t,n=0;return-1===e.indexOf("b")?e:(e=e.replace("b","#"),t=String.fromCharCode(e[0].toUpperCase().charCodeAt(0)-1),"@"===t&&(t="G"),"B"===t&&(n=e.search(/\d/),n>-1&&(e=e.substring(0,n)+(e[n]-1)+e.substring(n+1))),t+=e.substr(1))},tsw.getFrequency=function(t){var n,r,a,u;return o(t)===!1?!1:(a=t.search(/\d/),n=parseInt(t.slice(-1)),isNaN(n)&&(n=4),t=this.flatToSharp(t),u=t,a>-1&&(u=t.substr(0,a)),r=e.indexOf(u.toUpperCase()),r+=12*n,parseFloat(440*Math.pow(2,(r-57)/12),10))}}(window),function(e){"use strict";var t=function(){var e=function(e){this.context=e};return e.prototype.getUserMIDI=function(e,t){navigator.requestMIDIAccess().then(e,t)},e.prototype.MIDINumberToNote=function(e){var t=e%12,n=Math.floor(e/12),r=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return r[t]+n},e}();e.tsw.midi=new t}(window);