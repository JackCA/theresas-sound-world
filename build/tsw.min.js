/* Theresa's Sound World 0.0.1 (c) 2013 Stuart Memo */
!function(a,b){"use strict";var c,d="1.0.0";c=function(){var c=function(a,b){for(var c in b)a[c]=b[c];return a},e=function(a,b){for(var c in b)a[c].value=b[c]},f=function(a){return Array.isArray(a)},g=function(a){return"function"==typeof a},h=function(a){return"object"==typeof a},i=function(a){return"string"==typeof a},j=function(a){return"number"==typeof a},k=function(a){return"undefined"!=typeof a},l=function(a){var b=!1;return Object(a)&&"node"in a&&(b=!0),b},m=function(a){return"undefined"!=typeof a.context},n=function(a){return a.hasOwnProperty("input")||a.hasOwnProperty("output")},o=function(a){return h(a)?"setValueAtTime"in a:!1},p=function(a,b){var c=this;b.forEach(function(b){a[b]=function(a,d,e){return"undefined"==typeof a?c[b].hasOwnProperty("value")?c[b].value:c[b]:(c[b].hasOwnProperty("value")?(k(d)&&(e=e||0,c[b].setTargetAtTime(c[b].value,q.now(),e),c[b].setTargetAtTime(a,d,e)),c[b].value=a):c[b]=a,void 0)}})},q={},r=[];q.version=d,q.isBrowserSupported=!1,q.processors=[];var s=function(){q.noise_buffer=q.buffer();for(var a=0;a<q.noise_buffer.buffer().length;a++)q.noise_buffer.buffer().getChannelData(0)[a]=2*Math.random()-1},t=function(a,b){var c;if("undefined"==typeof webkitAudioContext&&"undefined"==typeof AudioContext)if("undefined"==typeof webkitAudiocontext().prototype.createGainNode)b("Sorry, your browser doesn't support a recent enough version of the Web Audio API.");else{var d=webkitAudiocontext().prototype;d.createGain=d.createGainNode,d.createDelay=d.createDelayNode,d.createScriptProcessor=d.createJavaScriptNode}else"function"==typeof AudioContext?(c=new AudioContext,q.context=function(){return c}):(c=new webkitAudioContext,q.context=function(){return c});q.isBrowserSupported=!0,a()},u=function(){q.speakers=q.context().destination},v=function(a){a.output.gain.cancelScheduledValues(q.now()),a.output.gain.setValueAtTime(0,q.now()),a.output.gain.exponentialRampToValueAtTime(1,q.now()+2)},w=function(a){a.output.gain.cancelScheduledValues(q.now()),a.output.gain.setValueAtTime(1,q.now()),a.output.gain.exponentialRampToValueAtTime(0,q.now()+2)};q.now=function(){return this.context().currentTime},q.channelMerger=function(a){return q.context().createChannelMerger(a)},q.connect=function(){for(var a=function(){arguments[0].connect(arguments[1])},b=function(){arguments[0].connect(arguments[1].input)},c=function(){for(var a=0;a<arguments[1].length;a++)q.connect(arguments[0],arguments[1][a])},d=function(){for(var a=0;a<arguments[0].length;a++)q.connect(arguments[0][a],arguments[1])},e=function(){arguments[0].output.connect(arguments[1].input)},g=function(){arguments[0].output.connect(arguments[1])},h=function(){for(var a=0;a<arguments[0].length;a++)q.connect(arguments[0][a],arguments[1])},i=function(){for(var a=0;a<arguments[0].length;a++)q.connect(arguments[0][a],arguments[1])},j=function(){arguments[0].node.connect(arguments[1].node,arguments[0].channel,arguments[1].channel)},k=0;k<arguments.length-1;k++){var o=arguments[k],p=arguments[k+1];m(o)&&n(p)?b(o,p):n(o)&&m(p)?g(o,p):m(o)&&f(p)?c(o,p):f(o)&&m(p)?d(o,p):m(o)&&m(p)?a(o,p):n(o)&&n(p)?e(o,p):n(o)&&f(p)?connectTswNodeToArray(o,p):f(o)&&n(p)?h(o,p):f(o)&&f(p)?i(o,p):l(o)&&f(p)?connectObjectWithNodeToArray(o,p):f(o)&&l(p)?connectArrayToObjectWithNode(o,p):l(o)&&l(p)&&j(o,p)}},q.disconnect=function(){for(var a=arguments.length,b=0;a>b;b++)arguments[b].disconnect()},q.disconnectAfterTime=function(a,b){r.push({node:a,time:b})},q.load=function(){var a,b,c={},d=arguments[0].files,e=arguments[0].path||"",f=[],h=0,i=0,j=this,k=function(a,b,c,d,e,f){var k=new XMLHttpRequest;k.open("GET",a+c,!0),k.responseType="arraybuffer";var l=function(){h++,j.context().decodeAudioData(k.response,function(a){d[b]=a,Object.keys(d).length===i&&e(d)})},m=function(){g(f)?f():console.log("There was an error loading your file(s)",k.status)};k.onreadystatechange=function(){4===k.readyState&&(200===k.status?l():m())},k.send()};if("object"==typeof arguments[1]?(e=arguments[1].path||"",f=arguments[1].extensions||[]):"function"==typeof arguments[1]&&(a=arguments[1]),"function"==typeof arguments[2]&&(b=arguments[2]),"object"==typeof d){i=Object.keys(d).length;for(var l in d)k(e,l,d[l],c,a,b)}else{if("string"!=typeof d)throw new Error("Files must be an array or a valid string.");i=1,k(e,l,d[l],c,a)}},q.wait=function(a){var b,c=this.context().createDelay();return a=a||1,b=q.createNode({nodeType:"delay"}),p.call(c,b,["delayTime"]),b.delayTime(a),q.connect(b.input,c,b.output),b},q.createMonoMaker=function(){var a={};return a.input=q.createGain(),a.output=q.createGain(),q.connect(a.input,a.output),a},q.panner=function(a){var b={},c=q.createGain(1),d=q.createGain(0),e=q.createChannelMerger(2);return b.input=q.createGain(),b.output=q.createGain(),b.value=a,b.value>1?b.value=1:b.value<-1&&(b.value=-1),c.gain.value=1-100*.01*((1+b.value)/2),d.gain.value=1-c.gain.value,q.connect(b.input,[c,d]),q.connect({node:c,channel:0},{node:e,channel:0}),q.connect({node:d,channel:0},{node:e,channel:1}),q.connect(e,b.output),b},q.play=function(a,b){b=b||0,a.start(b)},q.stop=function(a,b){b=b||0,a.stop(b)},q.reverse=function(a){for(var b=0;b<a.buffer.numberOfChannels;b++)Array.prototype.reverse.call(a.buffer.getChannelData(b));return a};var x=function(a){this.start=function(b){return a.sourceNode.hasOwnProperty("start")?a.sourceNode.start(b):a.sourceNode.noteOn(b),this},this.stop=function(b){return a.sourceNode.hasOwnProperty("stop")?a.sourceNode.stop(b):a.sourceNode.noteOff(b),this}};q.createNode=function(a){var b={};return a=a||{},b.input=q.context().createGain(),b.output=q.context().createGain(),b.nodeType=function(){return a.nodeType||"default"},b.attributes=a.attributes,b.connectedTo=[],a.hasOwnProperty("sourceNode")?x.call(b,a):a.sourceNode=!1,b},q.oscillator=function(a,b){var c,d=q.context().createOscillator();return c=q.createNode({sourceNode:d,nodeType:"oscillator"}),p.call(d,c,["type","frequency","waveType"]),c.type(a||"sine"),c.frequency(b||440),c.waveType=a||"sine",c.nodeType=function(){return"oscillator"},c.fadeIn=function(){return v(this),this},c.fadeOut=function(){return w(this),this},c.detune=function(a){return d.detune.value=a,this},c.type(c.waveType.toLowerCase()),c.isPlaying=function(){return 2===d.playbackState?!0:!1},c.returnNode=function(){return d},q.connect(d,c.output),c},q.gain=function(a){var b,c;return c="function"==typeof this.context().createGain?this.context().createGain():this.context().createGainNode(),b=q.createNode({nodeType:"gain"}),b.params={gain:c.gain},p.call(c,b,["gain"]),h(a)&&a.hasOwnProperty("gain")&&(a=a.gain.value),0>=a&&(a=0),"undefined"==typeof a&&(a=1),b.gain(a),q.connect(b.input,c,b.output),b},q.buffer=function(a,b,c){var d=q.createNode({nodeType:"buffer"});a=a||1,b=b||65536,c=c||44100;var e=this.context().createBuffer(a,b,c);return p.call(e,d,["numberOfChannels","bufferSize","sampleRate"]),d.data=function(b){if("undefined"==typeof b){for(var c=[],d=0;a>d;d++)c.push(e.getChannelData(d));return c}},d.buffer=function(){return e},d},q.bufferPlayer=function(a){var b=this.context().createBufferSource();return b.buffer=a,"undefined"==typeof b.start&&(b.start=b.noteOn,b.stop=b.noteOff),b},q.filter=function(){var a=q.createNode({nodeType:"filter"}),b={},c=q.context().createBiquadFilter();return h(arguments[0])?(b.type=arguments[0].type,b.frequency=arguments[0].frequency||1e3,b.Q=arguments[0].Q):i(arguments[0])&&(b.type=arguments[0]),b.type=b.type||"lowpass",b.Q=b.Q||0,p.call(c,a,["type","frequency","Q"]),a.type(b.type),a.frequency(b.frequency||1e3),a.Q(b.Q||0),q.connect(a.input,c,a.output),a},q.analyser=function(){return this.context().createAnalyser()},q.compressor=function(a){var b=q.createNode({nodeType:"compressor"}),d=this.context().createDynamicsCompressor(),f={threshold:-24,knee:30,ratio:12,attack:.003,release:.25};return a=c(f,a),e(d,a),q.connect(b.input,d,b.output),b},q.processor=function(a,b){var c=a||1024,d=q.context().createScriptProcessor(c,1,1);return"function"==typeof b&&(d.onaudioprocess=function(a){b(a)}),d},q.waveShaper=function(){for(var a=this.context().createWaveShaper(),b=new Float32Array(65536),c=0;32768>c;c++)b[c]=3e4>c?.1:-1;return a.curve=b,a},q.envelope=function(a){var c={};return a=a||{},c.name=a.name||"",c.startLevel=a.startLevel||0,c.maxLevel=a.maxLevel||1,c.minLevel=a.minLevel||0,c.param=a.param||null,c.nodeType=function(){return"envelope"},c.attackTime=a.attackTime||0,c.decayTime=a.decayTime||1,c.sustainLevel=a.sustainLevel||1,c.releaseTime=a.releaseTime||1,o(a.param)&&(c.param=a.param),c.autoStop=a.autoStop===b?!0:a.autoStop,c.start=function(){var a=this.attackTime+this.decayTime;a+this.releaseTime,this.maxLevel=this.startLevel+this.maxLevel,this.sustainLevel=this.startLevel+this.sustainLevel,o(this.param)&&(this.param.setValueAtTime(0,q.now()),this.param.linearRampToValueAtTime(this.maxLevel,q.now()+this.attackTime),this.param.setTargetAtTime(this.sustainLevel,q.now(),this.decayTime))},c.stop=function(a){a=a||q.now(),a+=this.releaseTime,!this.autoStop&&o(this.param)&&this.param.setTargetAtTime(this.minLevel,q.now(),this.releaseTime/10)},c},q.noise=function(){var a,b=this.bufferPlayer(q.noise_buffer.buffer());return a=q.createNode({nodeType:"noise",sourceNode:b,attributes:{color:"white"}}),b.loop=!0,p.call(b,a,["buffer"]),a.color=a.colour=function(b){return"undefined"==typeof b?a.attributes.color:(a.attributes.color=b,void 0)},a.nodeType=function(){return"noise"},a.play=function(a){b.start(a)},a},q.lfo=function(a){var b,d=q.oscillator(),e=this.gain(),f=this.bufferPlayer(q.noise_buffer.buffer()),g={frequency:0,waveType:"triangle",depth:1,target:null,autoStart:!1};return b=q.createNode({nodeType:"noise",sourceNode:f}),a=c(g,a),d.type(a.waveType||"triangle"),e.gain(a.depth),d.frequency(a.frequency),a.autoStart&&d.start(q.now()),d.modulate=function(a){q.connect(e,a)},d.setWaveType=function(a){d.type=d[a.toUpperCase()]},d.frequency=function(a){return"undefined"==typeof a?d.frequency.value:(d.frequency.value=a,void 0)},d.setDepth=function(a){e.gain.value=a},d.modulate(a.target),d},q.getUserAudio=function(a){var b=function(b){var c=q.context().createMediaStreamSource(b);a(c)};navigator.webkitGetUserMedia({audio:!0},b)};var y=function(){!function a(){r.forEach(function(a){a.time<q.now()&&q.disconnect(a.node)}),setTimeout(a,500)}()};return q.isString=i,q.isNumber=j,q.init=function(){t(function(){u(),s(),y()},function(a){console.log(a)})},a.tsw=q}(),c.init()}(window),function(a){"use strict";a.tsw=tsw||{};var b={};b.createDelay=function(a){var b=tsw.createNode(),c=tsw.createDelay(),d=tsw.createGain(),e=tsw.createGain(),f=tsw.createGain();return b.settings={delayTime:.5,feedback:.5,effectLevel:.5},a=a||{},c.delayTime.value=a.delayTime||b.settings.delayTime,d.gain.value=a.feedback||b.settings.feedback,e.gain.value=a.effectLevel||b.settings.effectLevel,tsw.connect(b.input,f,c,d,c,e,b.output),tsw.connect(f,c),b},b.createDistortion=function(a){var b={},c=tsw.context.createWaveShaper(),d=tsw.context.createBiquadFilter(),e=tsw.context.createBiquadFilter();return b.settings={distortionLevel:.5},a=a||{},b.input=tsw.createGain(),b.output=tsw.createGain(),tsw.connect(b.input,c,[d,e],b.output),b},b.createPhaser=function(a){var b={},c=[],d=tsw.createGain(),e={rate:8,depth:.5,feedback:.8};a=a||{},d.gain.value=a.gain||e.gain;for(var f=0;f<e.rate;f++)c[f]=tsw.context.createBiquadFilter(),c[f].type=7,c[f].frequency.value=100*f;b.input=tsw.createGain(),b.output=tsw.createGain();for(var f=0;f<c.length-1;f++)tsw.connect(c[f],c[f+1]);return tsw.connect(b.input,c[0],c[c.length-1],d,c[0]),tsw.connect(c[c.length-1],b.output),b.setCutoff=function(){for(var a=0;a<c.length;a++);},b},b.createReverb=function(a){var b=tsw.context.createConvolver(),c=tsw.createGain(),d={},e={effectLevel:.5,reverbTime:.5,reverbType:"spring",reverbPath:""};return a=a||{},c.gain.value=a.effectLevel||e.effectLevel,tsw.load({hall:"/effects/reverb/responses/bright-hall.wav",room:"/effects/reverb/responses/medium-room.wav",spring:"/effects/reverb/responses/feedback-spring.wav"},function(a){e.reverbPath=a[e.reverbType],b.buffer=e.reverbPath,d.input=tsw.createGain(),d.output=tsw.createGain(),tsw.connect(d.input,[d.output,b]),tsw.connect(b,c),tsw.connect(c,d.output)}),d},b.createTremolo=function(a){var b={},c=(tsw.createGain(),this.createLFO()),d=this;return a=a||{},b.input=tsw.createGain(),b.connect=function(a){b.input.connect(a),c.modulate(b.input.gain),c.start(d.now())},b.setRate=function(a){c.setFrequency(a)},b.setDepth=function(a){c.setDepth(a)},b},tsw.fx=b}(window),function(){"use strict";var a=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];a.push.apply(a,a);var b=["unison","flat 2nd","2nd","minor 3rd","major 3rd","perfect 4th","flat 5th","perfect 5th","minor 6th","major 6th","minor 7th","major 7th","octave","flat 9th","9th","sharp 9th","major 10th","11th","augmented 11th","perfect 12th","flat 13th","13th"],c=function(b){for(var c,d=a.length,e=0;d>e;e++)if(b.toUpperCase()===a[e])return c=e,e;return null},d=function(b){var d=[],e=c(b);return d.push(a[e]),d.push(a[e+2]),d.push(a[e+4]),d.push(a[e+5]),d.push(a[e+7]),d.push(a[e+9]),d.push(a[e+11]),d.push(a[e+12]),d},e=function(b){var d=[],e=c(b);return d.push(a[e]),d.push(a[e+2]),d.push(a[e+3]),d.push(a[e+5]),d.push(a[e+7]),d.push(a[e+8]),d.push(a[e+10]),d.push(a[e+12]),d},f=function(a){return"string"!=typeof a||a.length>3?!1:!0};tsw.chord=function(b){var d={},e=[],f=0;return Array.isArray(b)?!1:(b=b.toLowerCase(),d.rootNote=b[0].toUpperCase(),d.isMajor=b.indexOf("maj")>-1,d.isMinor=!d.isMajor&&b.indexOf("m")>-1,d.is7th=b.indexOf("7")>-1,d.notes=[],d.is7th||(d.octave=b.match(/\d/g)),d.isMajor||d.isMinor||b.is7th||(d.isMajor=!0),f=c(d.rootNote),e.push(f),b.isMinor?e.push(f+tsw.semitoneDifference("minor 3rd")):e.push(f+tsw.semitoneDifference("major 3rd")),e.push(f+tsw.semitoneDifference("perfect 5th")),e.push(f+tsw.semitoneDifference("octave")),e.forEach(function(b){d.notes.push(a[b])}),d.notes)},tsw.scale=function(a,b){return"minor"===b?e(a):d(a)},tsw.semitoneDifference=function(a){for(var c=b.length,d=0;c>d;d++)if(a===b[d])return d},tsw.flat=function(a){var b;return a=a.replace("#","b"),b=String.fromCharCode(a[0].toUpperCase().charCodeAt(0)+1),"H"===b&&(b="A"),b+=a.substr(1)},tsw.sharp=function(a){var b,c=0;return-1===a.indexOf("b")?a:(a=a.replace("b","#"),b=String.fromCharCode(a[0].toUpperCase().charCodeAt(0)-1),"@"===b&&(b="G"),"B"===b&&(c=a.search(/\d/),c>-1&&(a=a.substring(0,c)+(a[c]-1)+a.substring(c+1))),b+=a.substr(1))},tsw.frequency=function(b){var c,d,e,g;return f(b)===!1?!1:(e=b.search(/\d/),c=parseInt(b.slice(-1)),isNaN(c)&&(c=4),b=this.sharp(b),g=b,e>-1&&(g=b.substr(0,e)),d=a.indexOf(g.toUpperCase()),d+=12*c,parseFloat(440*Math.pow(2,(d-57)/12),10))}}(window),function(){"use strict";tsw=tsw||{},tsw.MIDISupport=function(){return"function"==typeof navigator.requestMIDIAccess},tsw.getUserMidi=function(a,b){tsw.MIDISupport()&&navigator.requestMIDIAccess().then(a,b)};var a=function(a){return a},b=function(){var a=number%12,b=Math.floor(number/12),c=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];return c.push.apply(c,c),c[a]+b};tsw.midiNote=function(c){return tsw.isString(c)?a(c):tsw.isNumber(c)?b(c):void 0}}(window);