(function(l,p){var g=function(){var d=function(a){if("undefined"===typeof webkitAudioContext.prototype.createGain){if("undefined"===typeof webkitAudioContext.prototype.createGainNode)throw Error("Sorry, your browser doesn't support a recent enough version of the Web Audio API.");webkitAudioContext.prototype.createGain=webkitAudioContext.prototype.createGainNode;webkitAudioContext.prototype.createScriptProcessor=webkitAudioContext.prototype.createJavaScriptNode}this.context=a||new webkitAudioContext;
this.version="0.0.1";this.speakers=this.context.destination;this.processors=[];this.context.createGain=this.context.createGainNode;try{this.context.createGain()}catch(b){}l.tswMusic&&(this.music=new tswMusic(this))};d.prototype.now=function(){return this.context.currentTime};var m=function(a,b){for(attr in b)a[attr]=b[attr];return a};d.prototype.applySettings=function(a,b){for(setting in b)a[setting].value=b[setting]};d.prototype.connect=function(){for(var a=0;a<arguments.length-1;a++)if(Array.isArray(arguments[a]))for(var b=
0;b<arguments[a].length;b++)this.connect(arguments[a][b],arguments[a+1]);else arguments[a].hasOwnProperty("output")?arguments[a+1].hasOwnProperty("input")?arguments[a].output.connect(arguments[a+1].input):arguments[a].output.connect(arguments[a+1]):arguments[a+1].hasOwnProperty("input")?arguments[a].connect(arguments[a+1].input):arguments[a].connect(arguments[a+1])};d.prototype.disconnect=function(a){a.disconnect()};d.prototype.load=function(a,b){var c={},n=0,d=0,f=this,g=function(a,b,c,g){var h=
new XMLHttpRequest;h.open("GET",b,!0);h.responseType="arraybuffer";h.onload=function(){n++;f.context.decodeAudioData(h.response,function(b){c[a]=f.context.createBufferSource();c[a].buffer=b;c[a].play=function(){f.play(this)};c[a].stop=function(){f.stop(this)};c[a].isPlaying=function(){return this.playbackState};n===d&&g(c)})};h.send()};if("object"===typeof a)for(var k in a)d++,g(k,a[k],c,b);else if("string"===typeof a)d=1,g(k,a[k],c,b);else throw Error("Files must be an array or a valid string.");
};d.prototype.play=function(a){a.start(0)};d.prototype.stop=function(a){a.stop(0)};d.prototype.reverse=function(a){for(var b=0;b<a.buffer.numberOfChannels;b++)Array.prototype.reverse.call(a.buffer.getChannelData(b));return a};d.prototype.createPanner=function(a){};d.prototype.createOscillator=function(a,b){var c=this.context.createOscillator();"undefined"===typeof c.start&&(c.start=c.noteOn,c.stop=c.noteOff);a=(a||"SINE").toUpperCase();c.type=c[a];c.safariType=a.toLowerCase();c.frequency.value=b||
440;return c};d.prototype.createGain=function(a){var b;b="function"===typeof this.context.createGain?this.context.createGain():this.context.createGainNode();b.gain.value=a||1;return b};d.prototype.createFilter=function(a){a=a||"lowpass";var b=this.context.createBiquadFilter();b.type=a;return b};d.prototype.createAnalyser=function(){return this.context.createAnalyser()};d.prototype.createCompressor=function(a){var b=this.context.createDynamicsCompressor();a=m({threshold:-24,knee:30,ratio:12,attack:0.0030,
release:0.25},a);this.applySettings(b,a);return b};d.prototype.createProcessor=function(a,b){var c=tsw.context.createScriptProcessor(a||1024,1,1);"function"===typeof b&&(c.onaudioprocess=function(a){b(a)});return c};d.prototype.createWaveShaper=function(){for(var a=new Float32Array(65536),b=0;32768>b;b++)a[b]=3E4>b?0.1:-1;b=this.context.createWaveShaper();b.curve=a;return b};d.prototype.createEnvelope=function(a){var b={};b.startLevel=a.startLevel||0;b.maxLevel=a.maxLevel||1;b.minLevel=a.minLevel||
0;b.attackTime=a.attackTime||0;b.decayTime=a.decayTime||0;b.sustainLevel=a.sustainLevel||0;b.releaseTime=a.releaseTime||0;b.param=a.param;b.param.value=b.startLevel;a.autoStop===p?b.autoStop=!0:b.autoStop=a.autoStop;b.start=function(a){this.maxLevel=this.startLevel+this.maxLevel;this.sustainLevel=this.startLevel+this.sustainLevel;this.startTime=a||tsw.now();this.attackTime=this.startTime+this.attackTime;this.decayTime=this.attackTime+this.decayTime;this.param.cancelScheduledValues(this.startTime);
this.param.setValueAtTime(this.startLevel,this.startTime);this.param.linearRampToValueAtTime(this.maxLevel,this.attackTime);this.param.linearRampToValueAtTime(this.startLevel+this.sustainLevel,this.decayTime);this.autoStop&&this.stop(this.decayTime)};b.stop=function(a){a=a||tsw.now();a+=this.releaseTime;this.param.linearRampToValueAtTime(this.startLevel,a)};return b};d.prototype.createNoise=function(a){a=this.context.createScriptProcessor(1024,0,1);a.onaudioprocess=function(a){for(var c=0;1024>c;c++)a.outputBuffer.getChannelData(0)[c]=
2*Math.random()-1};return a};d.prototype.createLFO=function(a){var b=tsw.createOscillator(),c=this.createGain();a=m({frequency:0,waveType:"triangle",depth:1,target:null,autoStart:!1},a);b.type=b[a.waveType]||b.TRIANGLE;c.gain.value=a.depth;b.frequency.value=a.frequency;a.autoStart&&b.start(tsw.now());b.modulate=function(a){this.connect(c);c.connect(a)};b.setWaveType=function(a){b.type=b[a.toUpperCase()]};b.setFrequency=function(a){b.frequency.value=a};b.setDepth=function(a){c.gain.value=a};b.modulate(a.target);
return b};var g={createDelay:function(a){var b={},c=tsw.context.createDelay(),d=tsw.context.createGain(),e=tsw.context.createGain(),f=tsw.createGain();b.input=tsw.createGain();b.output=tsw.createGain();b.settings={delayTime:0.5,feedback:0.5,effectLevel:0.5};a=a||{};c.delayTime.value=a.delayTime||b.settings.delayTime;d.gain.value=a.feedback||b.settings.feedback;e.gain.value=a.effectLevel||b.settings.effectLevel;tsw.connect(b.input,f,c,d,c,e,b.output);tsw.connect(f,c);return b},createDelay:function(a){var b=
{},c=tsw.context.createDelay(),d=tsw.context.createGain(),e=tsw.context.createGain(),f=tsw.createGain();b.input=tsw.createGain();b.output=tsw.createGain();b.settings={delayTime:0.5,feedback:0.5,effectLevel:0.5};a=a||{};c.delayTime.value=a.delayTime||b.settings.delayTime;d.gain.value=a.feedback||b.settings.feedback;e.gain.value=a.effectLevel||b.settings.effectLevel;tsw.connect(b.input,f,c,d,c,e,b.output);tsw.connect(f,c);return b},createDistortion:function(a){a={};var b=context.createWaveShaper(),
c=context.createBiquadFilter(),d=context.createBiquadFilter();a.settings={distortionLevel:0.5};a.input=tsw.createGain();a.output=tsw.createGain();tsw.connect(a.input,b,[c,d],a.output);return a},createFlanger:function(a){return{}},createPhaser:function(a){var b={},c=[],d=tsw.createGain(),e={rate:8,depth:0.5,feedback:0.8};a=a||{};d.gain.value=a.gain||e.gain;for(a=0;a<config.rate;a++)c[a]=tsw.context.createBiquadFilter(),c[a].type=7,c[a].frequency.value=100*a;b.input=tsw.createGain();b.output=tsw.createGain();
for(a=0;a<c.length-1;a++)tsw.connect(c[a],c[a+1]);tsw.connect(b.input,c[0],c[c.length-1],d,c[0]);tsw.connect(c[c.length-1],b.output);b.setCutoff=function(a){for(a=0;a<c.length;a++);};return b},createReverb:function(a){var b=tsw.context.createConvolver(),c=tsw.createGain(),d={},e="";a=a||{};c.gain.value=a.effectLevel||0.5;tsw.load({hall:"/effects/reverb/responses/bright-hall.wav",room:"/effects/reverb/responses/medium-room.wav",spring:"/effects/reverb/responses/feedback-spring.wav"},function(a){e=
a.spring;b.buffer=e;d.input=tsw.createGain();d.output=tsw.createGain();tsw.connect(d.input,[d.output,b]);tsw.connect(b,c);tsw.connect(c,d.output)});return d},createTremolo:function(a){var b={};tsw.createGain();var c=this.createLFO(),d=this;b.input=tsw.createGain();b.connect=function(a){b.input.connect(a);c.modulate(b.input.gain);c.start(d.now())};b.setRate=function(a){c.setFrequency(a)};b.setDepth=function(a){c.setDepth(a)};return b}};d.prototype.createEffect=function(a){return g["create"+a.charAt(0).toUpperCase()+
a.slice(1)]()};return function(a){return new d(a)}}();l.tsw=new g})(window);
