<!doctype html>
<html>
    <head>
        <meta charset="utf-8"/>
        <title>Drum Machine</title>
        <meta name="description" content="A drum machine made with the Web Audio API"/>
        <meta name="author" content="Stuart Memo"/>
        <link rel="stylesheet" media="screen, projection" href="drum-machine.css"/>
        <script src="//use.typekit.net/enw0xku.js"></script>
        <script>try{Typekit.load();}catch(e){}</script>
    </head>
    <body>
        <div class="drum-machine">
            <h1 class="tk-orgovan-rounded-web">Drum Machine</h1>
            <table>
                <thead>
                    <tr>
                        <th>Kick</th>
                        <th>Snare</th>
                        <th>Closed hat</th>
                        <th>Open hat</th>
                        <th>Clap</th>
                        <th>Tom</th>
                        <th>Cowbell</th>
                    </tr>
                </thead>
                <tbody>
                </tbody>
            </table>
            <div class="controls">
                <div class="sound-controls">
                    <button name="kick">Kick</button>
                    <button name="snare">Snare</button>
                    <button name="hihatClosed">Hihat - closed</button>
                    <button name="hihatOpen">Hihat - open</button>
                    <button name="clap">clap</button>
                    <button name="cowbell">cowbell</button>
                    <button name="tom">tom</button>
                </div>
                <div class="play-controls">
                    <label for="bpm">BPM</label>
                    <input name="bpm" type="range"/>
                    <button name="start">Start</button>
                </div>
            </div>
        </div>
        <script src="../../tsw-core.js"></script>
        <script src="../../tsw-effects.js"></script>
        <script src="../../tsw-music.js"></script>
        <script src="../../tsw-sequencer.js"></script>
        <script src="drum-machine.js"></script>
        <script>
            var drumMachine = new DrumMachine(),
                buttons = document.getElementsByTagName('button'),
                noButtons = buttons.length,
                drumTypes = [],
                tbody = document.getElementsByTagName('tbody')[0];

            drumTypes.push('kick', 'snare', 'closed-hat', 'open-hat', 'clap', 'tom', 'cowbell');

            drumTypes.forEach(function (drum) {
                var tr = document.createElement('tr');
                tbody.appendChild(tr);
                for (var i = 0; i < 16; i++) {
                    var td = document.createElement('td'),
                        button = document.createElement('button');
                    tr.appendChild(td);    
                    td.appendChild(button);

                    if ((i < 4) || ((i > 7) && (i < 12))) {
                        td.className = 'odd-col';
                    }
                }
            });

            for (var i = 0; i < noButtons; i++) {
                buttons[i].addEventListener('click', function () {
                    drumMachine.drums[this.name].play();
                });
            }
        </script>
    </body>
</html>
